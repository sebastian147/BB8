#include "GPIO.h"
#include "DR_teclado.h"


extern volatile uint32_t G_tecla; //agregado


uint8_t 	DR_lecturatecla		(void)
{
	if( GetPIN(tecla0) == Presionado )
		return TECLA0;
	if( GetPIN(tecla1)  == Presionado )
		return TECLA1;
	return NO_TECLA;
}
void		DR_Antirebote		(void)
{
	static uint8_t contador = 0;
	static uint8_t lastkey  = NO_TECLA;
	uint8_t tecla;

	tecla = DR_lecturatecla();


	if( tecla == lastkey && contador < Rebote )
	{
		contador++;
			if( contador == Rebote )
			{
				G_tecla=tecla;
			}
	}
	if( tecla != lastkey )
	{
		contador = 0;
	}
	lastkey = tecla;
}
void		init_teclado		(void)
{
	SetPINSEL( tecla0 , GPIOf );
	SetPINSEL( tecla1 , GPIOf );

	SetDIR( tecla0 , ENTRADA );
	SetDIR( tecla1 , ENTRADA );

	//SetPINSEL( 2 , 1 , GPIOf );
//	SetPINSEL( 2 , 2 , GPIOf );
	SetPINSEL( 2 , 3,  GPIOf );

	//SetDIR( 2,1 , SALIDA );
	//SetDIR( 2,2 , SALIDA );
	SetDIR( 2,3 , SALIDA );

	//SetPIN(2,1,0);
//	SetPIN(2,2,0);
	SetPIN(2,3,0);

	//esto es para los motores
	SetPINSEL(2,3,0);
	SetPINSEL(2,4,0);

	SetDIR(2,3,1);
	SetDIR(2,4,1);

	SetPIN(2,3,ON);
	SetPIN(2,4,OFF);
}
